<div class="fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50">
    <div class="bg-white rounded-2xl shadow-lg w-full max-w-md p-6 relative">

        <!-- Botón Cerrar simple -->
        <button 
        (click)="cancelar()"
        class="absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-2xl font-bold"
        >
        </button>

        <!-- Título del Modal -->
        <h2 class="text-xl font-semibold mb-4">{{ producto ? 'Editar Producto' : 'Nuevo Producto' }}</h2>

        <!-- Formulario -->
        <form (ngSubmit)="guardarProducto()" class="space-y-3">

        <div *ngIf="producto">
            <label class="block text-sm font-medium">Código</label>
            <input type="text" [(ngModel)]="codigo" disabled="" name="codigo" class="w-full border rounded px-2 py-1" required>
        </div>

        <div>
            <label class="block text-sm font-medium">Nombre</label>
            <input type="text" [(ngModel)]="nombre" name="nombre" class="w-full border rounded px-2 py-1" required>
        </div>

        <div>
            <label class="block text-sm font-medium">Descripción</label>
            <input type="text" [(ngModel)]="descripcion" name="descripcion" class="w-full border rounded px-2 py-1" required>
        </div>

        <div>
            <label class="block text-sm font-medium">Categoria</label>
        <select
        [(ngModel)]="categoria"
        name="categoria"
        class="filtro-select w-full border rounded px-2 py-1"
        [compareWith]="compararCategoria"
        >
        <option *ngFor="let cat of categorias" [ngValue]="cat.nombreCategoria">
            {{ cat.nombreCategoria }}
        </option>
        </select>
        </div>

        <div>
            <label class="block text-sm font-medium">Precio (S/)</label>
            <input type="number" [(ngModel)]="precio" name="precio" class="w-full border rounded px-2 py-1" required>
        </div>

        <div>
            <label class="block text-sm font-medium">Stock</label>
            <input type="number" [(ngModel)]="stock" name="stock" class="w-full border rounded px-2 py-1" required>
        </div>

        <div *ngIf="compararStock()">
            <label class="block text-sm font-medium">Razón de cambio de stock</label>
            <input type="text" [(ngModel)]="razonCambioStock" name="razonCambioStock" class="w-full border rounded px-2 py-1" required>
        </div>

        <!-- Botones Guardar / Cancelar / Eliminar -->
        <div class="flex justify-end gap-2 mt-4">
            <button type="button" (click)="cancelar()" class="px-3 py-1 rounded bg-gray-200 hover:bg-gray-300">Cancelar</button>
            
            <!-- Botón eliminar solo visible en editar -->
            <button *ngIf="producto" type="button" (click)="eliminarProducto()"
                    class="px-3 py-1 rounded bg-[#640b0b] text-white hover:bg-red-700 transition"
                    >Eliminar</button>

            <button *ngIf="producto" type="button" (click)="guardarProducto()" class="px-3 py-1 rounded bg-[#2C2C2D] text-white hover:opacity-90">
            Guardar
            </button>
            <button *ngIf="!producto" type="button" (click)="agregarProducto()" class="px-3 py-1 rounded bg-[#2C2C2D] text-white hover:opacity-90">
            Agregar
            </button>
        </div>

        </form>
    </div>
    </div>